diff --git a/buggy/storm-client/src/jvm/org/apache/storm/utils/TupleUtils.java b/fixed/storm-client/src/jvm/org/apache/storm/utils/TupleUtils.java
index 6c5c6b344..dff1ed24f 100644
--- a/buggy/storm-client/src/jvm/org/apache/storm/utils/TupleUtils.java
+++ b/fixed/storm-client/src/jvm/org/apache/storm/utils/TupleUtils.java
@@ -41,7 +41,7 @@ public final class TupleUtils {
     }
 
     public static <T> int chooseTaskIndex(List<T> keys, int numTasks) {
-        return Math.abs(listHashCode(keys)) % numTasks;
+        return Math.floorMod(listHashCode(keys), numTasks);
     }
 
     private static <T> int listHashCode(List<T> alist) {
