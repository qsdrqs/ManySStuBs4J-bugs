diff --git a/buggy/hikaricp/src/main/java/com/zaxxer/hikari/proxy/ConnectionProxy.java b/fixed/hikaricp/src/main/java/com/zaxxer/hikari/proxy/ConnectionProxy.java
index 33b6792c8..f348dca09 100644
--- a/buggy/hikaricp/src/main/java/com/zaxxer/hikari/proxy/ConnectionProxy.java
+++ b/fixed/hikaricp/src/main/java/com/zaxxer/hikari/proxy/ConnectionProxy.java
@@ -474,7 +474,7 @@ public abstract class ConnectionProxy implements IHikariConnectionProxy
       checkClosed();
       try {
          delegate.setCatalog(catalog);
-         isCatalogDirty = !catalog.equals(parentPool.catalog);
+         isCatalogDirty = (catalog != null && !catalog.equals(parentPool.catalog)) || (catalog == null && parentPool.catalog != null);
       }
       catch (SQLException e) {
          throw checkException(e);
