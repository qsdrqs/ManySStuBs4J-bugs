diff --git a/buggy/flink-compiler/src/main/java/org/apache/flink/compiler/postpass/JavaApiPostPass.java b/fixed/flink-compiler/src/main/java/org/apache/flink/compiler/postpass/JavaApiPostPass.java
index 22734612d..629517022 100644
--- a/buggy/flink-compiler/src/main/java/org/apache/flink/compiler/postpass/JavaApiPostPass.java
+++ b/fixed/flink-compiler/src/main/java/org/apache/flink/compiler/postpass/JavaApiPostPass.java
@@ -294,7 +294,7 @@ public class JavaApiPostPass implements OptimizerPostPass {
 		}
 		else if (typeInfo instanceof AtomicType) {
 			// handle grouping of atomic types
-			throw new UnsupportedOperationException("Grouping on atomic types is currently not implemented. " + typeInfo);
+			comparator = ((AtomicType) typeInfo).createComparator(sortOrder[0]);
 		}
 		else {
 			throw new RuntimeException("Unrecognized type: " + typeInfo);
