diff --git a/buggy/presto-hive/src/main/java/com/facebook/presto/hive/util/AsyncRecursiveWalker.java b/fixed/presto-hive/src/main/java/com/facebook/presto/hive/util/AsyncRecursiveWalker.java
index 7632e5e31..1e5788fac 100644
--- a/buggy/presto-hive/src/main/java/com/facebook/presto/hive/util/AsyncRecursiveWalker.java
+++ b/fixed/presto-hive/src/main/java/com/facebook/presto/hive/util/AsyncRecursiveWalker.java
@@ -71,7 +71,7 @@ public class AsyncRecursiveWalker
                 else {
                     callback.process(entry.getFileStatus(), entry.getBlockLocations());
                 }
-                if (future.isCancelled()) {
+                if (future.isDone()) {
                     return;
                 }
             }
