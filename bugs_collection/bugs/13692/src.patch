diff --git a/buggy/presto-main/src/main/java/com/facebook/presto/sql/planner/optimizations/AddLocalExchanges.java b/fixed/presto-main/src/main/java/com/facebook/presto/sql/planner/optimizations/AddLocalExchanges.java
index 489178bd7..be4fdb4d5 100644
--- a/buggy/presto-main/src/main/java/com/facebook/presto/sql/planner/optimizations/AddLocalExchanges.java
+++ b/fixed/presto-main/src/main/java/com/facebook/presto/sql/planner/optimizations/AddLocalExchanges.java
@@ -424,7 +424,8 @@ public class AddLocalExchanges
         {
             StreamPreferredProperties requiredProperties;
             StreamPreferredProperties preferredProperties;
-            if (getTaskWriterCount(session) > 1) {
+            // Force single writer when partition function exists
+            if (getTaskWriterCount(session) > 1 && !node.getPartitioningScheme().isPresent()) {
                 requiredProperties = fixedParallelism(getTaskWriterCount(session));
                 preferredProperties = fixedParallelism(getTaskWriterCount(session));
             }
