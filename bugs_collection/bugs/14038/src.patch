diff --git a/buggy/presto-main/src/main/java/com/facebook/presto/sql/analyzer/Analyzer.java b/fixed/presto-main/src/main/java/com/facebook/presto/sql/analyzer/Analyzer.java
index 63e0e3e3f..f6ef859bf 100644
--- a/buggy/presto-main/src/main/java/com/facebook/presto/sql/analyzer/Analyzer.java
+++ b/fixed/presto-main/src/main/java/com/facebook/presto/sql/analyzer/Analyzer.java
@@ -335,7 +335,7 @@ public class Analyzer
                 return super.visitFunctionCall(node, node); // visit children
             }
 
-            return super.visitFunctionCall(node, null);
+            return super.visitFunctionCall(node, enclosingAggregate);
         }
     }
 
