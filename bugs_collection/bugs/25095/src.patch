diff --git a/buggy/controller/src/main/java/org/jboss/as/controller/parsing/StandaloneXml.java b/fixed/controller/src/main/java/org/jboss/as/controller/parsing/StandaloneXml.java
index cd5ab76fa..5d2c94f53 100644
--- a/buggy/controller/src/main/java/org/jboss/as/controller/parsing/StandaloneXml.java
+++ b/fixed/controller/src/main/java/org/jboss/as/controller/parsing/StandaloneXml.java
@@ -398,7 +398,7 @@ public class StandaloneXml extends CommonXml {
             boolean deploymentWritten = false;
             for (String uniqueName : deploymentNames) {
                 final ModelNode deployment = modelNode.get(uniqueName);
-                if(!deployment.get(PERSISTENT).asBoolean()) {
+                if(deployment.hasDefined(PERSISTENT) && !deployment.get(PERSISTENT).asBoolean()) {
                     continue;
                 }
                 if(!deploymentWritten) {
