diff --git a/buggy/presto-main/src/main/java/com/facebook/presto/sql/planner/FragmentPlanner.java b/fixed/presto-main/src/main/java/com/facebook/presto/sql/planner/FragmentPlanner.java
index 69b593d7d..282407483 100644
--- a/buggy/presto-main/src/main/java/com/facebook/presto/sql/planner/FragmentPlanner.java
+++ b/fixed/presto-main/src/main/java/com/facebook/presto/sql/planner/FragmentPlanner.java
@@ -132,7 +132,7 @@ public class FragmentPlanner
 
             if (current.isPartitioned()) {
                 // create a new non-partitioned fragment
-                return newPlanFragment(new ExchangeNode(current.getId(), current.getRoot().getOutputSymbols()), false);
+                current = newPlanFragment(new ExchangeNode(current.getId(), current.getRoot().getOutputSymbols()), false);
             }
 
             current.setRoot(new OutputPlan(current.getRoot(), node.getColumnNames(), node.getAssignments()));
