diff --git a/buggy/presto-main/src/main/java/com/facebook/presto/execution/NodeScheduler.java b/fixed/presto-main/src/main/java/com/facebook/presto/execution/NodeScheduler.java
index d16c543f0..448d8faa6 100644
--- a/buggy/presto-main/src/main/java/com/facebook/presto/execution/NodeScheduler.java
+++ b/fixed/presto-main/src/main/java/com/facebook/presto/execution/NodeScheduler.java
@@ -182,7 +182,7 @@ public class NodeScheduler
                 }
             }
 
-            if (doubleScheduling) {
+            if (doubleScheduling && !selected.isEmpty()) {
                 // Cycle the nodes until we reach the limit
                 int uniqueNodes = selected.size();
                 int i = 0;
