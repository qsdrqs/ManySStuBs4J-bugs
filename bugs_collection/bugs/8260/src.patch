diff --git a/buggy/flink-test-utils-parent/flink-test-utils/src/main/java/org/apache/flink/test/util/JavaProgramTestBase.java b/fixed/flink-test-utils-parent/flink-test-utils/src/main/java/org/apache/flink/test/util/JavaProgramTestBase.java
index de536d81b..9262ae628 100644
--- a/buggy/flink-test-utils-parent/flink-test-utils/src/main/java/org/apache/flink/test/util/JavaProgramTestBase.java
+++ b/fixed/flink-test-utils-parent/flink-test-utils/src/main/java/org/apache/flink/test/util/JavaProgramTestBase.java
@@ -210,7 +210,7 @@ public abstract class JavaProgramTestBase extends AbstractTestBase {
 			e.printStackTrace();
 			Assert.fail("Error while calling the test program: " + e.getMessage());
 		} finally {
-			CollectionTestEnvironment.unsetAsContext();
+			miniClusterResource.getTestEnvironment().setAsContext();
 		}
 
 		Assert.assertNotNull("The test program never triggered an execution.", this.latestExecutionResult);
