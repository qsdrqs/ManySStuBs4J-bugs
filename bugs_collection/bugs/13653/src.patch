diff --git a/buggy/presto-main/src/main/java/com/facebook/presto/operator/AssignUniqueIdOperator.java b/fixed/presto-main/src/main/java/com/facebook/presto/operator/AssignUniqueIdOperator.java
index 683122b86..050efee46 100644
--- a/buggy/presto-main/src/main/java/com/facebook/presto/operator/AssignUniqueIdOperator.java
+++ b/fixed/presto-main/src/main/java/com/facebook/presto/operator/AssignUniqueIdOperator.java
@@ -106,7 +106,7 @@ public class AssignUniqueIdOperator
         this.rowIdPool = requireNonNull(rowIdPool, "rowIdPool is null");
 
         TaskId fullTaskId = operatorContext.getDriverContext().getTaskId();
-        uniqueValueMask = (fullTaskId.getStageId().getId() << 54L) | ((long) fullTaskId.getId() << 40L);
+        uniqueValueMask = (((long) fullTaskId.getStageId().getId()) << 54) | (((long) fullTaskId.getId()) << 40);
         inputPageChannelCount = types.size() - 1;
 
         requestValues();
