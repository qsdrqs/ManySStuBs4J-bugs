diff --git a/buggy/flink-libraries/flink-cep/src/main/java/org/apache/flink/cep/nfa/NFA.java b/fixed/flink-libraries/flink-cep/src/main/java/org/apache/flink/cep/nfa/NFA.java
index deee0a14b..5624db9de 100644
--- a/buggy/flink-libraries/flink-cep/src/main/java/org/apache/flink/cep/nfa/NFA.java
+++ b/fixed/flink-libraries/flink-cep/src/main/java/org/apache/flink/cep/nfa/NFA.java
@@ -1132,7 +1132,7 @@ public class NFA<T> implements Serializable {
 				int length = in.readInt();
 
 				byte[] serCondition = new byte[length];
-				in.read(serCondition);
+				in.readFully(serCondition);
 
 				ByteArrayInputStream bais = new ByteArrayInputStream(serCondition);
 				ObjectInputStream ois = new ObjectInputStream(bais);
