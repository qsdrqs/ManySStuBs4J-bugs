diff --git a/buggy/presto-hive/src/main/java/com/facebook/presto/hive/HiveClient.java b/fixed/presto-hive/src/main/java/com/facebook/presto/hive/HiveClient.java
index 57c320168..5278d0531 100644
--- a/buggy/presto-hive/src/main/java/com/facebook/presto/hive/HiveClient.java
+++ b/fixed/presto-hive/src/main/java/com/facebook/presto/hive/HiveClient.java
@@ -585,7 +585,7 @@ public class HiveClient
                                 break;
                             case DOUBLE:
                                 if (value.isEmpty()) {
-                                    builder.put(columnHandle, 0L);
+                                    builder.put(columnHandle, 0.0);
                                 }
                                 else {
                                     builder.put(columnHandle, parseDouble(value));
