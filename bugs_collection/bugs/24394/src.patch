diff --git a/buggy/testsuite/integration/basic/src/test/java/org/jboss/as/test/integration/naming/ExternalContextBindingTestCase.java b/fixed/testsuite/integration/basic/src/test/java/org/jboss/as/test/integration/naming/ExternalContextBindingTestCase.java
index cc6783a6e..65af00c5f 100644
--- a/buggy/testsuite/integration/basic/src/test/java/org/jboss/as/test/integration/naming/ExternalContextBindingTestCase.java
+++ b/fixed/testsuite/integration/basic/src/test/java/org/jboss/as/test/integration/naming/ExternalContextBindingTestCase.java
@@ -312,7 +312,10 @@ public class ExternalContextBindingTestCase {
     public static JavaArchive deploy() {
         return ShrinkWrap.create(JavaArchive.class, "externalContextBindingTest.jar")
                 .addClasses(ExternalContextBindingTestCase.class, LookupEjb.class)
-                .addAsManifestResource(createPermissionsXmlAsset(new JndiPermission("*", "lookup")), "jboss-permissions.xml");
+                .addAsManifestResource(createPermissionsXmlAsset(
+                        new JndiPermission("*", "lookup"),
+                        new RuntimePermission("accessClassInPackage.com.sun.jndi.ldap")
+                ), "jboss-permissions.xml");
     }
 
     @Test
