diff --git a/buggy/server/src/test/java/io/druid/client/client/BatchServerInventoryViewTest.java b/fixed/server/src/test/java/io/druid/client/client/BatchServerInventoryViewTest.java
index 38864822e..a777222ef 100644
--- a/buggy/server/src/test/java/io/druid/client/client/BatchServerInventoryViewTest.java
+++ b/fixed/server/src/test/java/io/druid/client/client/BatchServerInventoryViewTest.java
@@ -198,7 +198,8 @@ public class BatchServerInventoryViewTest
   private void waitForSync() throws Exception
   {
     Stopwatch stopwatch = new Stopwatch().start();
-    while (Iterables.get(batchServerInventoryView.getInventory(), 0).getSegments().size() != testSegments.size()) {
+    while (!Iterables.isEmpty(batchServerInventoryView.getInventory())
+           && Iterables.get(batchServerInventoryView.getInventory(), 0).getSegments().size() != testSegments.size()) {
       Thread.sleep(500);
       if (stopwatch.elapsed(TimeUnit.MILLISECONDS) > 5000) {
         throw new ISE("BatchServerInventoryView is not updating");
