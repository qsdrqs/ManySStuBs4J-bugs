diff --git a/buggy/src/main/java/org/apache/hadoop/hbase/client/coprocessor/AggregationClient.java b/fixed/src/main/java/org/apache/hadoop/hbase/client/coprocessor/AggregationClient.java
index 975bf6c65..ba7026332 100644
--- a/buggy/src/main/java/org/apache/hadoop/hbase/client/coprocessor/AggregationClient.java
+++ b/fixed/src/main/java/org/apache/hadoop/hbase/client/coprocessor/AggregationClient.java
@@ -105,7 +105,7 @@ public class AggregationClient {
 
       @Override
       public synchronized void update(byte[] region, byte[] row, R result) {
-        max = ci.compare(max, result) < 0 ? result : max;
+        max = (max == null || (result != null && ci.compare(max, result) < 0)) ? result : max;
       }
     }
     MaxCallBack aMaxCallBack = new MaxCallBack();
@@ -155,7 +155,7 @@ public class AggregationClient {
 
       @Override
       public synchronized void update(byte[] region, byte[] row, R result) {
-        min = (min == null || ci.compare(result, min) < 0) ? result : min;
+        min = (min == null || (result != null && ci.compare(result, min) < 0)) ? result : min;
       }
     }
     HTable table = new HTable(conf, tableName);
