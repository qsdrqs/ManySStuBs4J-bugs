diff --git a/buggy/presto-main/src/main/java/com/facebook/presto/cost/CostCalculatorUsingExchanges.java b/fixed/presto-main/src/main/java/com/facebook/presto/cost/CostCalculatorUsingExchanges.java
index 1efc10ef0..d7938b7bc 100644
--- a/buggy/presto-main/src/main/java/com/facebook/presto/cost/CostCalculatorUsingExchanges.java
+++ b/fixed/presto-main/src/main/java/com/facebook/presto/cost/CostCalculatorUsingExchanges.java
@@ -245,7 +245,7 @@ public class CostCalculatorUsingExchanges
                     node,
                     node.getLeft(),
                     node.getRight(),
-                    Objects.equals(node.getDistributionType(), Optional.of(JoinNode.DistributionType.REPLICATED)));
+                    node.getDistributionType() == SpatialJoinNode.DistributionType.REPLICATED);
         }
 
         @Override
