diff --git a/buggy/ql/src/java/org/apache/hadoop/hive/ql/stats/StatsUtils.java b/fixed/ql/src/java/org/apache/hadoop/hive/ql/stats/StatsUtils.java
index e0f401beb..1795ae562 100644
--- a/buggy/ql/src/java/org/apache/hadoop/hive/ql/stats/StatsUtils.java
+++ b/fixed/ql/src/java/org/apache/hadoop/hive/ql/stats/StatsUtils.java
@@ -1345,11 +1345,11 @@ public class StatsUtils {
     if (oi instanceof WritableStringObjectInspector) {
       WritableStringObjectInspector woi = (WritableStringObjectInspector) oi;
       return JavaDataModel.get().lengthForStringOfLength(
-          woi.getPrimitiveWritableObject(value).getLength());
+        value == null ? 0 : woi.getPrimitiveWritableObject(value).getLength());
     } else if (oi instanceof WritableBinaryObjectInspector) {
       WritableBinaryObjectInspector woi = (WritableBinaryObjectInspector) oi;
       return JavaDataModel.get().lengthForByteArrayOfSize(
-          woi.getPrimitiveWritableObject(value).getLength());
+        value == null ? 0 : woi.getPrimitiveWritableObject(value).getLength());
     } else if (oi instanceof WritableBooleanObjectInspector) {
       return JavaDataModel.get().primitive1();
     } else if (oi instanceof WritableByteObjectInspector) {
