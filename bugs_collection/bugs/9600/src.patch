diff --git a/buggy/ql/src/java/org/apache/hadoop/hive/ql/stats/StatsUtils.java b/fixed/ql/src/java/org/apache/hadoop/hive/ql/stats/StatsUtils.java
index fde8c5360..9ffd12ad3 100644
--- a/buggy/ql/src/java/org/apache/hadoop/hive/ql/stats/StatsUtils.java
+++ b/fixed/ql/src/java/org/apache/hadoop/hive/ql/stats/StatsUtils.java
@@ -1065,8 +1065,7 @@ public class StatsUtils {
       // epoch, days since epoch
       cs.setRange(0, 25201);
     } else {
-      // Columns statistics for complex datatypes are not supported yet
-      return null;
+      cs.setAvgColLen(getSizeOfComplexTypes(conf, cinfo.getObjectInspector()));
     }
     return cs;
   }
