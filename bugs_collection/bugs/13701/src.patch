diff --git a/buggy/presto-main/src/main/java/com/facebook/presto/operator/RowNumberOperator.java b/fixed/presto-main/src/main/java/com/facebook/presto/operator/RowNumberOperator.java
index e6a343647..771ffd8d8 100644
--- a/buggy/presto-main/src/main/java/com/facebook/presto/operator/RowNumberOperator.java
+++ b/fixed/presto-main/src/main/java/com/facebook/presto/operator/RowNumberOperator.java
@@ -275,7 +275,7 @@ public class RowNumberOperator
             pageBuilder.declarePosition();
             for (int i = 0; i < outputChannels.length; i++) {
                 int channel = outputChannels[i];
-                Type type = types.get(channel);
+                Type type = types.get(i);
                 type.appendTo(inputPage.getBlock(channel), currentPosition, pageBuilder.getBlockBuilder(i));
             }
             BIGINT.writeLong(pageBuilder.getBlockBuilder(rowNumberChannel), rowCount + 1);
